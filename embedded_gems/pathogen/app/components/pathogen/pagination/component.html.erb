<%# Main pagination container %>
<%= render Pathogen::BaseComponent.new(
      tag: :nav,
      **system_arguments,
      role: "navigation",
      "aria-label": aria_label,
      "aria-live": aria_live
    ) do %>
  <%# Info section with current page and range %>
  <div class="flex flex-col space-y-4">
    <%# Page size selector and info %>
    <div class="flex flex-wrap items-center justify-between gap-4">
      <%# Page size selector %>
      <div class="flex items-center space-x-2">
        <label
          for="page-size-selector"
          class="text-sm text-slate-700 dark:text-slate-300"
        >
          <%= t(".items_per_page") %>
        </label>
        <%= form_tag request.path, method: :get, class: "inline", data: { turbo_stream: 'true' } do %>
          <%= hidden_field_tag :page, 1 %>
          <%= select_tag :limit,
          options_for_select(page_sizes, pagy.vars[:items]),
          id: "page-size-selector",
          class:
            "
                                                                                                                                    rounded-lg border border-slate-300 bg-white px-3 py-2 pr-8 text-sm
                                                                                                                                    text-slate-700 focus:border-primary-500 focus:outline-none focus:ring-1
                                                                                                                                    focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-800
                                                                                                                                    dark:text-slate-300 dark:focus:border-primary-500 dark:focus:ring-primary-500
                                                                                                                                  ",
          onchange: "this.form.requestSubmit()",
          aria_label: t(".select_page_size") %>
        <% end %>
      </div>

      <%# Page info %>
      <div class="text-sm text-slate-700 dark:text-slate-300">
        <%= page_range_text %>
      </div>
    </div>

    <%# Navigation section %>
    <div class="flex flex-wrap items-center justify-between gap-4">
      <%# Jump to page (only in full mode) %>
      <% if mode == :full && pagy.pages > 1 %>
        <div class="flex items-center space-x-2">
          <label for="jump-to-page" class="text-sm text-slate-700 dark:text-slate-300">
            <%= t(".jump_to_page") %>
          </label>
          <%= form_tag request.path, method: :get, class: "inline", data: { turbo_stream: 'true' } do %>
            <%= hidden_field_tag :limit, pagy.vars[:items] %>
            <%= number_field_tag :page,
            pagy.page,
            id: "jump-to-page",
            min: 1,
            max: pagy.pages,
            class:
              "
                                                                                                                                                                                        w-20 rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm
                                                                                                                                                                                        text-slate-700 focus:border-primary-500 focus:outline-none focus:ring-1
                                                                                                                                                                                        focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-800
                                                                                                                                                                                        dark:text-slate-300 dark:focus:border-primary-500 dark:focus:ring-primary-500
                                                                                                                                                                                      ",
            onchange: "this.form.requestSubmit()",
            aria_label: t(".jump_to_page_aria_label") %>
            <span class="text-sm text-slate-700 dark:text-slate-300">
              <%= t(".of_pages", total: pagy.pages) %>
            </span>
          <% end %>
        </div>
      <% end %>

      <%# Pagination bar %>
      <nav class="pagy nav" aria-label="<%= navigation_aria_label %>">
        <ul class="inline-flex h-11 text-base">
          <% pagy.series.each_with_index do |item, idx| %>
            <% is_first = idx == 0 %>
            <% is_last = idx == pagy.series.size - 1 %>
            <li>
              <% if (item.is_a?(Integer) || (item.is_a?(String) && item.to_i == pagy.page)) && item.to_i == pagy.page %>
                <span
                  aria-current="page"
                  class="
                    flex items-center justify-center px-4 h-11 ms-0 leading-tight border
                    border-primary-600 bg-primary-100 text-primary-700 dark:bg-primary-900
                    dark:text-primary-200 font-bold text-sm cursor-default
                    <%= 'rounded-s-lg' if is_first %> <%= 'rounded-e-lg' if is_last %>
                    <%= 'border-l-0' unless is_first %>
                  "
                >
                  <%= item %>
                </span>
              <% elsif item.is_a?(Integer) || (item.is_a?(String) && item.to_i != pagy.page) %>
                <%= link_to url_for(params: request.query_parameters.merge(page: item, limit: pagy.vars[:items])),
                  class: "flex items-center justify-center text-slate-700 bg-white border border-slate-300 font-medium text-sm px-4 h-11 hover:bg-slate-100 hover:text-slate-900 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-700 dark:hover:bg-slate-700 dark:hover:text-slate-100
                    #{'rounded-s-lg' if is_first} #{'rounded-e-lg' if is_last} #{'border-l-0' unless is_first}",
                  data: { turbo_stream: 'true' },
                  aria_label: t('.go_to_page', page: item) do %>
                  <%= item %>
                <% end %>
              <% elsif item == :gap %>
                <span
                  class="
                    flex items-center justify-center px-4 h-11 ms-0 leading-tight border
                    border-slate-300 text-slate-600 bg-slate-100 dark:bg-slate-800
                    dark:text-slate-400 dark:border-slate-700 cursor-default #{'rounded-s-lg' if
                    is_first} #{'rounded-e-lg' if is_last} #{'border-l-0' unless is_first}
                  "
                >...</span>
              <% end %>
            </li>
          <% end %>
        </ul>
      </nav>
    </div>
  </div>
<% end %>
