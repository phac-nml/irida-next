# Read about fixtures at https://api.rubyonrails.org/classes/ActiveRecord/FixtureSet.html

DEFAULTS: &DEFAULTS
  workflow_type: "NFL"
  workflow_type_version: "DSL2"
  workflow_engine: "nextflow"
  workflow_engine_version: "23.10.0"

workflow_execution_valid:
  <<: *DEFAULTS
  metadata: { "workflow_name": "wn1", "workflow_version": "wv1" }
  workflow_params: { "key_a": "value_a" }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "my_workflow_url"
  run_id: "my_run_id_1"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:john_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:project1_namespace, :uuid) %>

workflow_execution_invalid_metadata:
  <<: *DEFAULTS
  metadata: { "workflow_name": "wn1", "missing a param here": "invalid" }
  workflow_params: { "key_a": "value_a" }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "my_workflow_url"
  run_id: "my_run_id_2"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:john_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:project1_namespace, :uuid) %>

irida_next_example:
  <<: *DEFAULTS
  metadata:
    { workflow_name: "phac-nml/iridanextexample", workflow_version: "1.0.2" }
  workflow_params: { "assembler": "stub" }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/iridanextexample"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:john_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:project1_namespace, :uuid) %>

  email_notification: true

irida_next_example_prepared:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_prepared",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_prepared"
  run_id: "my_run_id_4"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:john_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:project1_namespace, :uuid) %>
  state: "prepared"
  email_notification: true

irida_next_example_submitted:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_submitted",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_prepared"
  run_id: "my_run_id_5"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:john_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:project1_namespace, :uuid) %>
  state: "submitted"

irida_next_example_completed:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_completed",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_completed"
  run_id: "my_run_id_6"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:john_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:project1_namespace, :uuid) %>
  state: "completed"
  blob_run_directory: "not a run dir"

irida_next_example_error:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_error",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_error"
  run_id: "my_run_id_7"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:john_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:project1_namespace, :uuid) %>
  state: "error"

irida_next_example_canceling:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_canceling",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_canceling"
  run_id: "my_run_id_8"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:john_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:project1_namespace, :uuid) %>
  state: "canceling"

irida_next_example_canceled:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_canceled",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_canceled"
  run_id: "my_run_id_9"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:john_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:project1_namespace, :uuid) %>
  state: "canceled"

irida_next_example_running:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_running",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_running"
  run_id: "my_run_id_10"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:john_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:project1_namespace, :uuid) %>
  state: "running"

irida_next_example_new:
  <<: *DEFAULTS
  metadata:
    { "workflow_name": "irida_next_example_new", "workflow_version": "1.0dev" }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_new"
  run_id: "my_run_id_12"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:john_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:project1_namespace, :uuid) %>
  state: "initial"

irida_next_example_completing_a:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_completing",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_completed"
  run_id: "my_run_id_a"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:jeff_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:projectA_namespace, :uuid) %>
  state: "completing"
  blob_run_directory: "not a run dir"
  email_notification: true

irida_next_example_completing_b:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_completing",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_completed"
  run_id: "my_run_id_b"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:jeff_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:projectA_namespace, :uuid) %>
  state: "completing"
  blob_run_directory: "not a run dir"

irida_next_example_completing_c:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_completing",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_completed"
  run_id: "my_run_id_c"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:jeff_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:projectA_namespace, :uuid) %>
  state: "completing"
  blob_run_directory: "not a run dir"
  update_samples: true

irida_next_example_completing_d:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_completing",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_completed"
  run_id: "my_run_id_d"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:jeff_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:projectA_namespace, :uuid) %>
  state: "completing"
  blob_run_directory: "not a run dir"

irida_next_example_completing_e:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_completing",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_completed"
  run_id: "my_run_id_e"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:jeff_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:projectA_namespace, :uuid) %>
  state: "completing"
  blob_run_directory: "not a run dir"

irida_next_example_completing_f:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_completing",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_completed"
  run_id: "my_run_id_f"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:jeff_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:projectA_namespace, :uuid) %>
  state: "completing"
  blob_run_directory: "not a run dir"
  update_samples: false

irida_next_example_completed_with_output:
  <<: *DEFAULTS
  metadata:
    {
      "workflow_name": "irida_next_example_completed",
      "workflow_version": "1.0dev",
    }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_completed_with_output"
  run_id: "my_run_id_13"
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:john_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:projectA_namespace, :uuid) %>
  state: "completed"
  blob_run_directory: "not a run dir"

<% (1..25).each do |n| %>
workflow_execution<%= (n) %>:
  <<: *DEFAULTS
  metadata:
    { "workflow_name": <%= "Workflow Execution #{n}" %>, "workflow_version": "1.0dev" }
  workflow_params:
    {
      "input": "/blah/samplesheet.csv",
      "outdir": "/blah/output",
    }
  workflow_engine_parameters: { "-r": "dev" }
  workflow_url: "https://github.com/phac-nml/irida_next_example_new"
  run_id: <%= "my_run_id_#{n}" %>
  submitter_id: <%= ActiveRecord::FixtureSet.identify(:jane_doe, :uuid) %>
  namespace_id: <%= ActiveRecord::FixtureSet.identify(:project33_namespace, :uuid) %>
  state: "initial"
<% end %>

