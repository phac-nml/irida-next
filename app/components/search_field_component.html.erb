<%= render Viral::BaseComponent.new(tag: :div, **system_arguments) do %>
  <div class="relative">
    <div class="relative">
      <%= @form.search_field @field_name,
                         "data-search-field-target": "input",
                         "data-test-selector":
                           !Rails.env.production? ? "search-field-input" : nil,
                         class:
                           "t-search-component md:w-80 w-full p-2.5 pr-10 text-sm text-slate-900 border border-slate-300 rounded-lg bg-white dark:bg-slate-700 dark:border-slate-600 dark:placeholder-slate-300 dark:text-white peer",
                         aria: {
                           label: t("components.search_field_component.instructions"),
                         },
                         placeholder: " ",
                         value: @value %>
      <%= @form.label @field_name,
                  @label,
                  class:
                    "absolute cursor-text text-sm text-slate-500 bg-transparent dark:text-slate-400 duration-300 transform -translate-y-4 top-2 z-10 origin-[0] dark:bg-gray-900 px-2 peer-focus:px-2 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:bg-white peer-focus:top-2 peer-focus:-translate-y-5 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1" %>

    </div>
    <!-- Clear button (shown only when there are existing search results) -->
    <button
      type="button"
      data-search-field-target="clearButton"
      data-action="click->search-field#clear"
      class="
        absolute inset-y-0 right-0 flex items-center justify-center w-12
        pointer-events-auto cursor-pointer rounded-r-lg transition-colors border-t
        border-r border-b border-slate-300 dark:border-slate-600 hover:bg-slate-100
        dark:hover:bg-slate-600 <%= clear_button? ? '' : 'hidden' %>
      "
      aria-label="<%= t('components.search_field_component.clear_button') %>"
    >
      <%= pathogen_icon(ICON::X, size: :sm, color: :subdued) %>
    </button>
    <!-- Submit/search button (hidden while clear button is active) -->
    <button
      type="submit"
      data-search-field-target="submitButton"
      data-action="
        click->search-field#clearSelection
        click->search-field#updateFocus
      "
      class="
        absolute inset-y-0 right-0 flex items-center justify-center w-12
        pointer-events-auto cursor-pointer rounded-r-lg transition-colors border-t
        border-r border-b border-slate-300 dark:border-slate-600 hover:bg-slate-100
        dark:hover:bg-slate-600 <%= clear_button? ? 'hidden' : '' %>
      "
      aria-label="<%= t('components.search_field_component.search_button') %>"
    >
      <%= pathogen_icon(ICON::MAGNIFYING_GLASS, size: :sm, color: :subdued) %>
    </button>
  </div>
<% end %>
