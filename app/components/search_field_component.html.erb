<%= render Viral::BaseComponent.new(tag: :div, **system_arguments) do %>
  <%= @form.label @field_name, @label, class: "sr-only" %>
  <div class="relative h-[44px]">
    <%= @form.search_field @field_name,
                       "data-search-field-target": "input",
                       "data-test-selector":
                         !Rails.env.production? ? "search-field-input" : nil,
                       class:
                         "t-search-component h-full w-full placeholder-shown:field-sizing-content block p-2.5 pr-11.5 text-sm text-slate-900 border border-slate-300 rounded-lg bg-slate-50 dark:bg-slate-700 dark:border-slate-600 dark:placeholder-slate-300 dark:text-white",
                       aria: {
                         description:
                           t("components.search_field_component.instructions"),
                       },
                       placeholder: @placeholder,
                       value: @value %>
    <!-- Clear button (shown only when there are existing search results) -->
    <button
      type="button"
      data-search-field-target="clearButton"
      data-action="click->search-field#clear"
      class="
        absolute inset-y-0 right-0 flex items-center justify-center w-[44px]
        pointer-events-auto cursor-pointer rounded-r-lg transition-colors border-t
        border-r border-b border-slate-300 dark:border-slate-600 hover:bg-slate-100
        dark:hover:bg-slate-600 <%= clear_button? ? '' : 'hidden' %>
      "
      aria-label="<%= t('components.search_field_component.clear_button') %>"
    >
      <%= pathogen_icon(:x, size: :sm, color: :subdued) %>
    </button>
    <!-- Submit/search button (hidden while clear button is active) -->
    <button
      type="submit"
      data-search-field-target="submitButton"
      data-action="
        click->search-field#clearSelection
        click->search-field#updateFocus
      "
      class="
        absolute inset-y-0 right-0 flex items-center justify-center w-[44px]
        pointer-events-auto cursor-pointer rounded-r-lg transition-colors border-t
        border-r border-b border-slate-300 dark:border-slate-600 hover:bg-slate-100
        dark:hover:bg-slate-600 <%= clear_button? ? 'hidden' : '' %>
      "
      aria-label="<%= t('components.search_field_component.search_button') %>"
    >
      <%= pathogen_icon("magnifying-glass", size: :sm, color: :subdued) %>
    </button>
  </div>
<% end %>
