<div data-action="keydown->viral--select2#keydown" class="select2">
  <% input_attrs = {
    type: "text",
    id: id,
    name: id,
    "data-viral--select2-target": "input",
    "data-action": "input->viral--select2#input",
    placeholder: placeholder,
    autocomplete: "off",
    class: "select2-input border-slate-300 text-slate-800 sm:text-sm rounded-lg block w-full p-2.5 dark:bg-slate-800 dark:border-slate-600 dark:placeholder-slate-400 dark:text-slate-50",
    aria: {
      invalid: aria_invalid,
      required: aria_required,
    }
  } %>

  <% input_attrs[:required] = true if required %>
  <% input_attrs[:value] = selected_value if selected_value.present? %>

  <% if aria_describedby.present? %>
    <% input_attrs[:aria][:describedby] = aria_describedby %>
  <% end %>

  <%= tag.input(**input_attrs) %>
  <%= form.hidden_field name, data: { "viral--select2-target": "hidden" } %>

  <div
    data-viral--select2-target="dropdown"
    class="
      z-10 hidden w-full bg-white divide-y rounded-lg shadow-sm divide-slate-100
      dark:bg-slate-700
    "
  >
    <ul
      data-viral--select2-target="scroller"
      role="listbox"
      class="
        max-h-[300px] w-full py-2 overflow-y-auto divide-y divide-slate-200
        dark:divide-slate-800
      "
    >
      <% options.each do |option| %>
        <%= option %>
      <% end %>

      <% if empty_state? %>
        <li
          role="option"
          aria-disabled="true"
          aria-selected="false"
          class="
            hidden p-4 text-blue-800 border border-blue-300 bg-blue-50 dark:bg-slate-800
            dark:text-blue-400 dark:border-blue-800 pointer-events-none
          "
          data-viral--select2-target="empty"
        >
          <%= empty_state %>
        </li>
      <% end %>
    </ul>
  </div>
</div>
