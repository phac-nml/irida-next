<aside
  id="sidebar"
  class="
    flex flex-col text-sm border-r sidebar border-slate-200 bg-white
    dark:border-slate-800 dark:bg-slate-900 max-xl:fixed max-xl:top-0
    max-xl:bottom-0 z-30 overflow-hidden
  "
  aria-label="Sidebar"
>
  <div class="flex flex-col h-full">
    <div
      class="
        flex overflow-visible justify-between items-center px-2 whitespace-nowrap
        bg-slate-100 dark:bg-slate-800 h-14 shrink-0 relative
      "
    >
      <a
        href="<%= root_path %>"
        class="whitespace-nowrap py-2.5 focus:outline-offset-2 relative"
        data-layout-target="logo"
      >
        <%= helpers.render_icon :irida_logo,
                            class: "size-8 text-primary-600 rotate-12 inline-block ml-1" %>
        <span class="text-sm font-semibold text-slate-700 dark:text-slate-200">
          <%= t(:"general.name") %>
        </span>
      </a>
      <div class=" flex flex-row shrink-0 justify-end items-center space-x-1">
        <button
          data-action="click->layout#collapse"
          class="
            navbar-button cursor-pointer hover:bg-slate-300 dark:hover:bg-slate-700
            dark:text-slate-500 dark:hover:text-slate-100
          "
          aria-label="<%= t(:'general.navbar.collapse.aria_label') %>"
        >
          <%= helpers.render_icon :sidebar, class: "size-6" %>
        </button>
        <!-- Add new items -->
        <%= viral_dropdown(icon: "plus", skidding: -300, dropdown_styles: "width: 276px;", aria: { label: t(:'general.navbar.new_dropdown.aria_label') }, classes: "p-1 navbar-button text-slate-500 hover:bg-slate-200 dark:text-slate-400 dark:hover:bg-slate-700") do |dropdown| %>
          <%= dropdown.with_item(
            label: t(:"general.navbar.new_dropdown.project"),
            url: new_project_path,
          ) %>
          <%= dropdown.with_item(
            label: t(:"general.navbar.new_dropdown.group"),
            url: new_group_path,
          ) %>
        <% end %>
        <!-- Profile menu -->
        <%= viral_dropdown(icon: "user_circle", skidding: -300, dropdown_styles: "width: 276px;", aria: { label: t(:'general.navbar.account_dropdown.aria_label') }, classes: "p-1 navbar-button text-slate-500 hover:bg-slate-200 dark:text-slate-400 dark:hover:bg-slate-700") do |dropdown| %>
          <%= dropdown.with_item(
            label: t(:"general.navbar.account_dropdown.profile"),
            url: profile_path,
          ) %>
          <%= dropdown.with_item(
            label: t(:"general.navbar.account_dropdown.sign_out"),
            url: destroy_user_session_path,
            data: {
              turbo_method: :delete,
            },
          ) %>
        <% end %>
      </div>
    </div>
    <div
      class="p-2 bg-slate-100 dark:bg-slate-800 dark:border-slate-800 shrink-0"
      data-controller="viral--dropdown"
      data-viral--dropdown-skidding-value="0"
      data-viral--dropdown-distance-value="5"
      data-viral--dropdown-trigger-value="click"
      data-viral--dropdown-position-value="bottom-start"
    >
      <button
        class="
          py-2 w-full rounded-md transition-colors duration-200 cursor-pointer
          min-h-[44px] flex items-center justify-center bg-slate-200 text-slate-900
          dark:bg-slate-200 dark:text-slate-50 font-semibold hover:bg-slate-300
          dark:hover:bg-slate-500
        "
        data-viral--dropdown-target='trigger'
        aria-haspopup="listbox"
        aria-controls="sidebar-dd-menu"
        aria-expanded="false"
      ><%= t(:"general.default_sidebar.goto") %></button>
      <div
        id="sidebar-dd-menu"
        role="menu"
        aria-expanded="false"
        data-viral--dropdown-target="menu"
        class="
          hidden z-20 mx-3 w-56 bg-white rounded-lg divide-y shadow-sm divide-slate-100
          dark:bg-slate-700
        "
        aria-hidden="true"
        tabindex="-1"
        hidden="hidden"
      >
        <h3 class="py-2 pl-4 font-semibold text-slate-900 dark:text-white">
          <%= t(:"general.default_sidebar.title") %>
        </h3>
        <ul class="py-2 w-full text-sm text-slate-700 dark:text-slate-200">
          <li role="presentation">
            <%= link_to t(:"general.default_sidebar.projects"),
            dashboard_projects_path,
            role: "menuitem",
            class:
              "px-4 py-2 block text-base hover:bg-slate-100 hover:cursor-pointer dark:hover:bg-slate-600" %>
          </li>
          <li role="presentation"><%= link_to t(:"general.default_sidebar.groups"),
            groups_path,
            role: "menuitem",
            class:
              "px-4 py-2 block text-base hover:bg-slate-100 hover:cursor-pointer dark:hover:bg-slate-600" %></li>
          <li role="presentation"><%= link_to t(:"general.default_sidebar.workflows"),
            workflow_executions_path,
            role: "menuitem",
            class:
              "px-4 py-2 block text-base hover:bg-slate-100 hover:cursor-pointer dark:hover:bg-slate-600" %></li>
          <li role="presentation"><%= link_to t(:"general.default_sidebar.data_exports"),
            data_exports_path,
            role: "menuitem",
            class:
              "px-4 py-2 block text-base hover:bg-slate-100 hover:cursor-pointer dark:hover:bg-slate-600" %></li>
        </ul>
      </div>
    </div>
    <div class="flex-1 flex flex-col overflow-hidden">
      <%# Render the header slot if it's provided %>
      <turbo-frame id="sidebar-header" class="shrink-0"><%= header %></turbo-frame>

      <%# Main content: sections and items passed to the component - only this section should scroll %>
      <div class="pt-1 px-2 space-y-1 overflow-y-auto flex-1">
        <%# Iterate over sections and render them %>
        <% sections.each do |section| %>
          <%= section %>
        <% end %>
        <%# Iterate over items and render them %>
        <% items.each do |item| %>
          <%= item %>
        <% end %>
      </div>
    </div>
  </div>
  <div class="p-2 border-t border-slate-200 dark:border-slate-800 shrink-0">
    <a
      href="https://phac-nml.github.io/irida-next/docs/intro"
      class="
        flex items-center justify-center w-full px-4 py-2 text-sm font-medium
        text-slate-700 rounded-lg dark:text-slate-200 hover:bg-slate-100
        dark:hover:bg-slate-700 min-h-[44px]
      "
    >
      <%= helpers.render_icon :question, class: "w-5 h-5 mr-2" %>
      <%= t("general.help") %>
    </a>
  </div>
</aside>
<div
  class="
    fixed xl:invisible xl:hidden sidebar-overlay h-screen w-screen backdrop-blur-xs
    bg-slate-200/40 dark:bg-slate-600/40 z-25
  "
  data-layout-target="sidebarOverlay"
>
</div>
