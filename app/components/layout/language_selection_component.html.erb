<div data-controller="language-selection-dd" class="inline-flex items-center">
  <button
    data-language-selection-dd-target="trigger"
    title="<%= t("shared.samples.metadata_templates.tooltip") %>"
    id="language-selection-dd-trigger"
    class="
      text-slate-900 bg-white border border-slate-300 hover:bg-slate-100 rounded-lg
      text-sm px-5 py-2.5 dark:bg-slate-800 dark:text-white dark:border-slate-600
      dark:hover:bg-slate-700 dark:hover:border-slate-600 cursor-pointer inline-flex
      items-center justify-center
    "
    type="button"
    aria-haspopup="listbox"
    aria-expanded="false"
    aria-controls="language-selection-dd-menu"
  >
    <%= viral_icon(name: "language", classes: "w-4 h-4 mr-2 flex-none") %>
    <span class="text-sm" id="language-selection-dd-label">
      <%= I18n.t(:"locales.#{locale}", locale: locale) %>
    </span>
  </button>
  <!-- Dropdown menu -->
  <div
    data-language-selection-dd-target="menu"
    id="language-selection-dd-menu"
    class="
      hidden w-32 bg-white divide-y divide-slate-100 rounded-lg shadow-sm
      dark:bg-slate-700 dark:divide-slate-600 z-30
    "
    aria-labelledby="language-selection-dd-trigger"
    tabindex="-1"
  >
    <ul
      id="language_selection_dropdown"
      role="listbox"
      class="py-2 text-sm text-slate-700 dark:text-slate-200"
    >
      <% @locale_options.each do |key, value| %>
        <li role="option">
          <%= form_with(model: @user, url: profile_preferences_path, method: :patch) do |form| %>
            <%= form.hidden_field :locale, value: value, id: "language_selection_#{value}" %>
            <%= form.submit key,
                        class:
                          "flex w-full items-center px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-600 dark:hover:text-white" %>
          <% end %>
        </li>
      <% end %>
    </ul>
  </div>
</div>
