<a
  id="main-content-link"
  class="
    button absolute top-3 left-3 z-[9999] -translate-y-[150%] transform button-primary shadow-lg
    transition-transform duration-300 ease-in-out focus:translate-y-0
  "
  href="#main-content"
  data-turbo="false"
  tabindex="0"
>
  <%= t(:"components.layout.main_content_link") %>
</a>

<div class="flex h-screen w-screen flex-col bg-white dark:bg-slate-800">
  <% if site_banners.any? %>
    <section class="w-full shrink-0 border-b border-slate-200 dark:border-slate-700">
      <div
        class="flex flex-col"
        role="status"
        aria-live="polite"
        aria-atomic="true"
      >
        <% site_banners.each do |banner| %>
          <%= render Viral::AlertComponent.new(
            type: banner[:type],
            message: banner[:message],
            dismissible: false,
            announce_alert: false,
            classes: "rounded-none border-x-0 border-t-0",
          ) %>
        <% end %>
      </div>
    </section>
  <% end %>

  <div
    class="
      h-full min-h-0 w-full flex-1 transition-all max-xl:collapsed xl:grid xl:grid-cols-(--layout-body-columns)
      xl:grid-rows-1
    "
    data-controller="layout"
    data-layout-target="layoutContainer"
    data-layout-collapsed-announcement-value="<%= t(:'components.layout.sidebar.collapsed_announcement') %>"
    data-layout-expanded-announcement-value="<%= t(:'components.layout.sidebar.expanded_announcement') %>"
    data-turbo-prefetch="false"
  >
    <%= sidebar %>

    <div
      class="content relative h-full overflow-x-hidden max-xl:overflow-y-auto xl:overflow-y-hidden"
      data-layout-target="content"
    >
      <header
        class="
          z-20 flex h-16 w-full gap-2 border-b border-slate-200 bg-white -outline-offset-1 max-sm:px-2 sm:px-4
          xl:absolute xl:top-0 dark:border-slate-950 dark:bg-slate-800
        "
      >
        <div class="inline-flex items-center max-xl:visible xl:hidden" data-layout-target="expandButtonContainer">
          <% expand_tooltip_id = Pathogen::Tooltip.generate_id(base_name: "layout-expand") %>

          <div data-controller="pathogen--tooltip">
            <%= tag.button(
              data: {
                action: "click->layout#expand:capture",
                layout_target: "expandButton",
                "pathogen--tooltip-target": "trigger"
              },
              aria: {
                describedby: expand_tooltip_id,
                label: t(:'general.navbar.toggle_sidebar'),
                controls: "sidebar",
                expanded: "true"
              },
              class: "text-slate-500 navbar-button cursor-pointer"
            ) do %>
              <%= pathogen_icon :sidebar %>
            <% end %>

            <%= render Pathogen::Tooltip.new(
              text: t(:"general.navbar.toggle_sidebar"),
              id: expand_tooltip_id,
              placement: :bottom,
            ) %>
          </div>
        </div>

        <div class="flex h-full max-w-full min-w-0 flex-1 items-center">
          <turbo-frame id="breadcrumb" class="contents"><%= breadcrumb %></turbo-frame>
        </div>

        <%= language_selection %>
      </header>

      <main
        id="main-content"
        tabindex="-1"
        class="
          @container w-full max-sm:p-2 sm:p-4 xl:absolute xl:top-16 xl:bottom-0 xl:overflow-x-hidden
          xl:overflow-y-auto
        "
      >
        <div class="<%= @layout %>"><%= body %></div>
      </main>

      <%= render ConfirmationComponent.new %>

      <div id="flashes" class="fixed top-5 right-6 z-50 flex flex-col">
        <% flash.each do |key, value| %>
          <%= viral_flash(type: key, data: value) %>
        <% end %>
      </div>

      <span
        class="sr-only"
        role="status"
        aria-live="polite"
        aria-atomic="true"
        data-layout-target="announcement"
      ></span>
    </div>

    <div tabindex="0" data-action="focus->layout#handleContentFocus"></div>
  </div>
</div>
