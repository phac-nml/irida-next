<div class="relative overflow-x-auto shadow-md sm:rounded-lg">
  <% data = parse_excel_file(@attachment.file) %>
  <% headers = data.first %>
  <% rows = data[1..] %>
  <% if data.present? %>
    <table
      class="
        w-full text-sm text-left rtl:text-right text-slate-500 dark:text-slate-400
      "
    >
      <thead
        class="
          text-xs text-slate-700 uppercase bg-slate-50 dark:bg-slate-700
          dark:text-slate-400
        "
      >
        <tr>
          <% headers.each do |header| %>
            <th scope="col" class="px-6 py-3">
              <%= header %>
            </th>
          <% end %>
        </tr>
      </thead>
      <tbody
        class="
          bg-white divide-y divide-slate-200 dark:bg-slate-800 dark:divide-slate-700
        "
      >
        <% rows.each do |row| %>
          <tr class="hover:bg-slate-50 dark:hover:bg-slate-600">
            <% row.each do |_key, value| %>
              <td class="px-6 py-4 whitespace-nowrap">
                <%= value %>
              </td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <div
      class="
        p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-slate-800
        dark:text-red-400
      "
      role="alert"
    >
      Error parsing excel file
    </div>
  <% end %>
</div>
