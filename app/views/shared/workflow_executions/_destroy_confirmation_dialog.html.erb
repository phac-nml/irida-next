<%= viral_dialog(open: true, size: :large) do |dialog| %>
  <%= dialog.with_header(title: t(".title")) %>
  <%= dialog.with_section do %>
    <%# TODO: maybe add broadcast target %>
    <%# <%= turbo_stream_from @broadcast_target %>
    <%= turbo_frame_tag "workflow_executions_dialog_content" do %>
      <div
        data-controller="infinite-scroll"
        data-infinite-scroll-selection-outlet='#workflow-executions-table'
        data-infinite-scroll-paged-field-name-value="workflow_execution_ids[]"
        data-infinite-scroll-singular-description-value="<%= t(".description.singular") %>"
        data-infinite-scroll-plural-description-value="<%= t(".description.plural") %>"
      >
        <%= form_with(
        url: list_workflow_executions_path(list_class: 'workflow_execution', list_action: 'destroy'),
        data: { "infinite-scroll-target": "pageForm" }
      ) do %>
          <div data-infinite-scroll-target="pageFormContent"></div>
        <% end %>

        <div class="grid gap-4">
          <div data-controller="collapsible">
            <h2 id="<%= "accordion-collapse-heading-workflows" %>">
              <button
                type="button"
                class="
                  flex items-center justify-between w-full p-3 font-medium rtl:text-right
                  text-black dark:text-white border border-slate-200 dark:border-slate-700
                  hover:bg-slate-100 dark:hover:bg-slate-800 gap-3 rounded-t
                "
                data-action="collapsible#toggle"
                aria-expanded="true"
                aria-controls="<%= "accordion-collapse-body-workflows" %>"
              >
                <span data-infinite-scroll-target="selectionCount">"<%= t(".selection_count.zero") %>"</span>
                <%= viral_icon(
                  name: "chevron_down",
                  classes: "mr-0 w-4 h-4 rotate-0",
                  "data-collapsible-target": "icon",
                ) %>
              </button>
            </h2>

            <div
              data-collapsible-target="item"
              id="<%= "accordion-collapse-body-workflows" %>"
              class="hidden"
              aria-labelledby="<%= "accordion-collapse-heading-workflows" %>"
            >
              <div
                class="
                  text-base leading-relaxed text-slate-500 dark:text-slate-400 p-2.5 border
                  border-t-0 border-slate-300
                "
              >
                <span data-infinite-scroll-target="summary">
                  <%= t(".description.zero") %>
                </span>
              </div>
              <div
                class="
                  overflow-y-auto max-h-[200px] border border-t-0 border-slate-300 rounded-b block
                  w-full p-2.5 dark:bg-slate-800 dark:border-slate-600
                "
                data-action="scroll->infinite-scroll#scroll"
                data-infinite-scroll-target="scrollable"
              >
                <%= turbo_frame_tag "list_selections" do %>
                  <%= render partial: "shared/loading/samples_list_skeleton" %>
                <% end %>
              </div>
            </div>
          </div>
          <%= form_for(:destroy, url: destroy_multiple_workflow_executions_path, method: :delete,
          data: {
            controller: "form--hidden-inputs",
            "form--hidden-inputs-selection-outlet": '#workflow-executions-table',
            "form--hidden-inputs-field-name-value": "destroy[workflow_execution_ids][]",
          }
        ) do |form| %>
            <%# <input type="hidden" name="broadcast_target" value="<%= @broadcast_target %>
            <div class="grid gap-4">

              <div>
                <%= form.submit t(".submit_button"),
                            class: "button button--size-default button--state-primary",
                            disabled: true,
                            data: {
                              action: "click->form--hidden-inputs#clearSelection",
                            } %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  <% end %>
<% end %>
