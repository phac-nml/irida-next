<%= turbo_stream.update "file_selector_dialog",
                    partial: "file_selector/file_selector_dialog",
                    locals: {
                      open: false,
                      file_selector_params:,
                    } %>

<turbo-stream
  action="replace"
  target="<%= "#{@attachable.id}_#{file_selector_params["name"]}"%>"
>
  <template>
    <%= render Nextflow::Samplesheet::FileCellComponent.new(
      @attachable,
      file_selector_params["name"],
      @attachment_params,
      file_selector_params["index"],
      file_selector_params["required"],
      file_selector_params["files"],
    ) %>
  </template>
</turbo-stream>

<% if @associated_attachment_params %>
  <% associated_name =
    file_selector_params["name"] == "fastq_1" ? "fastq_2" : "fastq_1" %>
  <turbo-stream
    action="replace"
    target="<%= "#{@attachable.id}_#{associated_name}"%>"
  >
    <template>
      <%= render Nextflow::Samplesheet::FileCellComponent.new(
        @attachable,
        associated_name,
        @associated_attachment_params,
        file_selector_params["index"],
        file_selector_params["required"],
        file_selector_params["files"],
      ) %>
    </template>
  </turbo-stream>
<% end %>
