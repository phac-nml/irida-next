<%= turbo_frame_tag "sample_files_modal" %>

<%= render Viral::PageHeaderComponent.new(title: @sample.name, subtitle: @sample.description) do |component| %>
  <%= component.with_icon(name: "beaker", classes: "h-14 w-14 text-primary-700") %>
  <%= component.with_buttons do %>
    <div class="flex flex-row">
      <% if allowed_to?(:new?, @project) %>
        <%= link_to(
          t("projects.samples.show.edit_button"),
          edit_namespace_project_sample_path(id: @sample.id),
          class: "button button--state-primary button--size-default mr-1"
        ) %>
      <% end %>
      <% if allowed_to?(:destroy?, @project) %>
        <%= link_to(
          t("projects.samples.show.remove_button"),
          namespace_project_sample_path(id: @sample.id, format: :html),
          data: {
            turbo_method: :delete,
            turbo_confirm: t("projects.samples.show.remove_button_confirmation")
          },
          class: "button button--state-default button--size-default mr-1"
        ) %>
      <% end %>
    </div>
  <% end %>
<% end %>

<div class="bg-white dark:bg-slate-800">
  <%= turbo_frame_tag "new_member_modal" %>
  <%= turbo_frame_tag "member-update-alert" %>

  <%= viral_tabs(id: "sample-data-tabs", label: "Files table") do |tabs| %>
    <%= tabs.with_tab(url: namespace_project_sample_path(id: @sample.id, tab: 'files'), controls: "sample-data-tabs", selected: @tab == "files" || @tab.nil?) do %>
      <%= t(:"projects.samples.show.tabs.files") %>
    <% end %>

    <%= tabs.with_tab(url: namespace_project_sample_path(id: @sample.id, tab: 'metadata'), controls: "sample-data-tabs", selected: @tab == "metadata") do %>
      <%= t(:"projects.samples.show.tabs.metadata") %>
    <% end %>

    <%= tabs.with_tab_content do %>
      <div class="flex flex-col">
        <%= turbo_frame_tag "table-listing", "data-turbo-temporary": true,
                            src:
                              (
                                namespace_project_sample_path(
                                  format: :turbo_stream,
                                  tab: @tab
                                )
                              ),
                            loading: :lazy do %>
          <table class="min-w-full table-fixed dark:divide-gray-600">
            <tbody
              class="
                bg-white
                divide-y
                divide-gray-200
                dark:bg-gray-800
                dark:divide-gray-700
              "
            >
              <% 10.times do %>
                <tr>

                  <td class="p-4 animate-pulse">
                    <div class="flex-1 py-1 space-y-6">
                      <div class="space-y-3">
                        <div class="w-48 h-2 rounded bg-slate-200"></div>
                        <div class="w-32 h-2 rounded bg-slate-200"></div>
                      </div>
                    </div>
                  </td>

                </tr>
              <% end %>
            </tbody>
          </table>
        <% end %>
        <%= turbo_frame_tag "pagination", "data-turbo-temporary": true %>
      </div>
    <% end %>
  <% end %>

</div>
