<%= turbo_frame_tag("attachments") do %>
  <div class="table-container">
    <table class="w-full text-sm text-left text-slate-500 dark:text-slate-400 mb-4">
      <thead class="text-slate-700 bg-slate-50 dark:bg-slate-900 dark:text-slate-400">
        <tr>
          <th></th>
          <th scope="col" class="px-6 py-3"><%= t("projects.samples.show.table_header.filename") %></th>
          <th class="px-6 py-3">format</th>
          <th class="px-6 py-3">type</th>
          <th scope="col" class="px-6 py-3"><%= t("projects.samples.show.table_header.size") %></th>
          <th scope="col" class="px-6 py-3"><%= t("projects.samples.show.table_header.created_at") %></th>
          <th scope="col" class="px-6 py-3"><%= t("projects.samples.show.table_header.action") %></th>
        </tr>
      </thead>
      <tbody id="attachments-table-body">
        <% attachments.each_with_index do |attachment, index| %>
          <% if attachment.fastq? && attachment.metadata.key?('associated_attachment_id') %>
            <%# Checks for attachment is the first in a paired end attachment %>
            <% if index+1 != attachments.length && attachment.metadata['associated_attachment_id'] == attachments[index+1].id %>
            <%= render partial: "projects/samples/attachments/attachment",
                locals: {
                  attachment: attachment,
                  row_action: 'span'
              } %>
            <%# Checks for attachment is the second in a paired end attachment %>
            <% elsif attachment.metadata['associated_attachment_id'] == attachments[index-1].id %>
              <%= render partial: "projects/samples/attachments/attachment",
                locals: {
                  attachment: attachment,
                  row_action: 'skip'
              } %>
            <%# Removeable once delete function removes both paired end attachments %>
            <% else %>
            <%= render partial: "projects/samples/attachments/attachment",
            locals: {
              attachment: attachment,
              row_action: nil
            } %>
            <% end %>
          <% else %>
          <%= render partial: "projects/samples/attachments/attachment",
          locals: {
            attachment: attachment,
            row_action: nil
          } %>
          <% end %>
        <% end %>
      </tbody>
    </table>
    <div class="empty_state_message">
      <%= viral_empty(
            title: t(:'projects.samples.show.no_files'),
            description: t(:'projects.samples.show.no_associated_files'),
            icon_name: :document_text) %>
    </div>
  </div>
<% end %>
