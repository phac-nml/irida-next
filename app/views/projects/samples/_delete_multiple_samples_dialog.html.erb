<%= viral_dialog(open: open) do |dialog| %>
  <%= dialog.with_header(title: t(".title")) %>
  <%= dialog.with_section do %>
    <div
      data-controller="infinite-scroll"
      data-infinite-scroll-selection-outlet='#samples-table'
      data-infinite-scroll-field-name-value="multiple_deletion[sample_ids][]"
      data-infinite-scroll-paged-field-name-value="sample_ids[]"
    >
      <%= form_with(
        url: list_namespace_project_samples_path,
        data: { "infinite-scroll-target": "pageForm" }
      ) do %>
        <div data-infinite-scroll-target="pageFormContent"></div>
      <% end %>
      <div
        class="overflow-y-auto max-h-[300px] mb-4"
        data-action="scroll->infinite-scroll#scroll"
        data-infinite-scroll-target="scrollable"
      >
        <%= turbo_frame_tag "list_select_samples" do %>
          <div role="status" class="max-w-sm animate-pulse">
            <% 4.times do %>
              <div class="h-2 bg-gray-200 rounded-full dark:bg-gray-700 max-w-[360px] mb-2.5"></div>
              <div class="h-2 bg-gray-200 rounded-full dark:bg-gray-700 mb-2.5"></div>
              <div class="h-2 bg-gray-200 rounded-full dark:bg-gray-700 max-w-[330px] mb-2.5"></div>
              <div class="h-2 bg-gray-200 rounded-full dark:bg-gray-700 max-w-[300px] mb-2.5"></div>
              <div class="h-2 bg-gray-200 rounded-full dark:bg-gray-700 max-w-[360px] mb-2.5"></div>
            <% end %>
            <span class="sr-only">loading</span>
          </div>
        <% end %>
      </div>

      <%= form_for(:deletion, url: destroy_multiple_namespace_project_samples_path, method: :delete,
            data: {
              controller: "spinner",
              action:"turbo:submit-start->spinner#submitStart turbo:submit-end->spinner#submitEnd"
            }
          ) do |form| %>
        <div class="grid gap-4">
          <div class="hidden" data-infinite-scroll-target="all"></div>
          <div>
            <%= form.submit t(".submit_button"),
                        class: "button button--size-default button--state-primary",
                        data: {
                          action: "click->infinite-scroll#clear",
                          "spinner-target": "submit",
                          "turbo-submits-with": 'loading'
                        } %>
          </div>
        </div>
      <% end %>
    </div>

    <div
      role="status"
      id="spinner"
      class="
        hidden backdrop-blur-sm absolute h-full w-full -translate-x-1/2 -translate-y-1/2
        top-2/4 left-1/2 grid place-items-center
      "
    >
      <div class="grid place-items-center">
        <%= viral_icon(name: :loading, classes: "animate-spin text-primary-500") %>
        <span class="text-black dark:text-white">spimn.</span>
      </div>
    </div>

  <% end %>
<% end %>
