<div class="relative overflow-x-auto shadow-md sm:rounded-lg" data-turbo-temporary>
  <table
  id="samples-table"
  class="w-full text-sm text-left rtl:text-right text-slate-500 dark:text-slate-400"
  data-controller="selection"
  data-selection-action-link-outlet=".action-link"
>
    <thead class="text-xs text-slate-700 uppercase bg-slate-50 dark:bg-slate-700 dark:text-slate-400">
    <tr>
      <% if allowed_to?(:transfer_sample?, project) %>
      <th aria-hidden="true"></th>
      <% end %>
      <th scope="col" class="px-6 py-3 text-left">
        <%= render Ransack::SortComponent.new(ransack_obj: @q, label: t(".sample"), url: sorting_url(@q, :name), field: :name) %>
      </th>
      <th scope="col" class="px-6 py-3 text-left">
        <%= render Ransack::SortComponent.new(ransack_obj: @q, label: t(".created_at"), url: sorting_url(@q, :created_at), field: :created_at) %>
      </th>
      <th scope="col" class="px-6 py-3 text-left">
        <%= render Ransack::SortComponent.new(ransack_obj: @q, label: t(".updated_at"), url: sorting_url(@q, :updated_at), field: :updated_at) %>
      </th>
      <% @template.each do |column| %>
        <th scope="col" class="px-6 py-3 text-left"><%= column %></th>
      <% end %>
      <% if allowed_to?(:update_sample?, project) %>
      <th scope="col" class="px-6 py-3 text-right"><%= t(".action") %></th>
      <% end %>
    </tr>
  </thead>
  <tbody
    class="
      bg-white
      divide-y
      divide-slate-200
      dark:bg-slate-800
      dark:divide-slate-700
    "
  >
    <% samples.each do |sample| %>
      <tr
        id="<%= dom_id(sample) %>"
        class="bg-white border-b dark:bg-slate-800 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600"
      >
        <% if allowed_to?(:transfer_sample?, project) %>
          <td class="w-10 ps-4">
            <%= check_box_tag "sample_ids[]",
            sample.id,
            nil,
            id: dom_id(sample),
            "aria-label": sample.name,
            data: {
              action: "input->selection#toggle",
              selection_target: "rowSelection"
            },
            class:
              "w-4 h-4 text-primary-600 bg-slate-100 border-slate-300 rounded focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-slate-800 focus:ring-2 dark:bg-slate-700 dark:border-slate-600" %>
          </td>
        <% end %>
        <td class="px-6 py-3 whitespace-nowrap">
          <%= link_to sample.name,
          namespace_project_sample_path(id: sample.id),
          data: {
            turbo: false
          },
          class: "text-grey-900 dark:text-grey-100 font-semibold hover:underline" %>
        </td>
        <td class="px-6 py-3 whitespace-nowrap">
          <%= l(sample.created_at.localtime, format: :full_date) %>
        </td>
        <td class="px-6 py-3 whitespace-nowrap">
          <%= viral_time_ago(original_time: sample.updated_at) %>
        </td>
        <% @template.each do |column| %>
          <td class="px-6 py-3 whitespace-nowrap">
            <%= sample[column].present? ? sample[column] : sample.metadata[column] %>
          </td>
        <% end %>
        <% if allowed_to?(:update_sample?, project) %>
          <td class="px-6 py-3 whitespace-nowrap">
            <div class="flex items-center justify-end">
              <%= viral_dropdown(icon: "ellipsis_vertical", aria: { label: t(:'projects.samples.index.actions.dropdown_aria_label', sample_name: sample.name) }) do |dropdown| %>
                <%= dropdown.with_item(
                  label: t(:"projects.samples.index.edit_button"),
                  url: edit_namespace_project_sample_path(id: sample.id),
                  data: {
                    turbo: false
                  }
                ) %>
                <% if allowed_to?(:destroy_sample?, @project) %>
                  <%= dropdown.with_item(
                    label: t(:"projects.samples.index.remove_button"),
                    url: namespace_project_sample_path(id: sample.id),
                    data: {
                      turbo_method: :delete,
                      turbo_confirm: t(:"projects.samples.index.remove_button_confirmation")
                    }
                  ) %>
                <% end %>
              <% end %>
            </div>
          </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
</div>